<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with Zonation results • zonator</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with Zonation results">
<meta property="og:description" content="zonator">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zonator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/zonator-project.html">Working with Zonation projects</a>
    </li>
    <li>
      <a href="../articles/zonator-results.html">Working with Zonation results</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cbig/zonator/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="zonator-results_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with Zonation results</h1>
                        <h4 class="author">Joona Lehtomäki</h4>
            
            <h4 class="date">2020-05-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cbig/zonator/blob/master/vignettes/zonator-results.Rmd"><code>vignettes/zonator-results.Rmd</code></a></small>
      <div class="hidden name"><code>zonator-results.Rmd</code></div>

    </div>

    
    
<div id="introduction-to-working-with-zonation-results" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-to-working-with-zonation-results" class="anchor"></a>1. Introduction to working with Zonation results</h2>
<p>First, let’s set up the scene. For the examples below to work, make sure you have installed <a href="https://github.com/cbig/zdat"><code>zdat</code></a> package. If not, do the following:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'zdat'</span>, <span class="kw">repos</span><span class="kw">=</span><span class="st">'https://jlehtoma.github.io/drat/'</span>,
                 <span class="kw">type</span><span class="kw">=</span><span class="st">'source'</span>)</pre></body></html></div>
<p>Now we start working with <code>zonator</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">zonator</span>)

<span class="co"># Start by creating a project using the tutorial data</span>
<span class="no">setup.dir</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/basic"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"zdat"</span>)
<span class="no">tutorial.project</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/load_zproject.html">load_zproject</a></span>(<span class="no">setup.dir</span>)

<span class="co"># Get a specific variant, 01_core_area_zonation</span>
<span class="no">variant.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_variant-methods.html">get_variant</a></span>(<span class="no">tutorial.project</span>, <span class="st">"01"</span>)

<span class="co"># Let's also rename the features and groups while we're at it</span>
<span class="fu"><a href="../reference/featurenames-methods.html">featurenames</a></span>(<span class="no">variant.caz</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Koala"</span>, <span class="st">"Masked.owl"</span>, <span class="st">"Powerful.owl"</span>,
                             <span class="st">"Tiger.quoll"</span>, <span class="st">"Sooty.owl"</span>, <span class="st">"Squirrel.glider"</span>,
                             <span class="st">"Yellow-bellied.glider"</span>)

<span class="fu"><a href="../reference/groupnames-methods.html">groupnames</a></span>(<span class="no">variant.caz</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span> <span class="kw">=</span> <span class="st">"mammals"</span>, <span class="st">"2"</span> <span class="kw">=</span> <span class="st">"owls"</span>)</pre></body></html></div>
<p>Each variant can either already have results (i.e. Zonation run has completed) or then not. Which results exactly are available can be determined by using method <code><a href="../reference/has_results-methods.html">has_results()</a></code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/has_results-methods.html">has_results</a></span>(<span class="no">variant.caz</span>)</pre></body></html></div>
<pre><code>## $curves
## [1] TRUE
## 
## $grp.curves
## [1] TRUE
## 
## $rank
## [1] TRUE
## 
## $wrscr
## [1] FALSE
## 
## $prop
## [1] FALSE
## 
## $ppa.lsm
## [1] FALSE
## 
## $features.info
## [1] TRUE</code></pre>
<p>Value <code>TRUE</code> indicates that Zonation has already been run and results are available and <code>FALSE</code> indicates that results are not available.</p>
<p>Results of a given variant - if present - can be extracted using <code><a href="../reference/results-methods.html">results()</a></code>. The resulting object will be an instance of <code>Zresults</code> class.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">results.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/results-methods.html">results</a></span>(<span class="no">variant.caz</span>)</pre></body></html></div>
<p>Object <code>results.caz</code> can in turn be queried with various dedicated methods described in more detail below.</p>
<hr>
</div>
<div id="performance-curves" class="section level2">
<h2 class="hasAnchor">
<a href="#performance-curves" class="anchor"></a>2. Performance curves</h2>
<div id="working-with-performance-data" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-performance-data" class="anchor"></a>2.1 Working with performance data</h3>
<p>Raw curves data (with or without groups) can be extracted from the variant or results using <code><a href="../reference/curves-methods.html">curves()</a></code>. Optional argument <code>groups</code> defines whether feature or group specific curves are returned. If you don’t need every feature or aggregate statistic, you can also get the data for particular features.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># Get feature-specific curves</span>
<span class="no">feature.curves.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">results.caz</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">feature.curves.caz</span>)</pre></body></html></div>
<pre><code>##   pr_lost   cost  min_pr  ave_pr    w_pr  ext1    ext2 Koala Masked.owl Powerful.owl Tiger.quoll Sooty.owl
## 1 0.00002 110280 1.00000 1.00000 1.00000 0e+00 0.00000 1.000      1.000        1.000           1     1.000
## 2 0.00102 110170 0.99959 0.99976 0.99976 3e-05 0.00006 1.000      1.000        1.000           1     1.000
## 3 0.00201 110060 0.99915 0.99949 0.99949 4e-05 0.00013 0.999      1.000        0.999           1     0.999
## 4 0.00301 109950 0.99866 0.99918 0.99918 5e-05 0.00021 0.999      1.000        0.999           1     0.999
## 5 0.00401 109840 0.99813 0.99883 0.99883 6e-05 0.00029 0.998      0.999        0.998           1     0.999
## 6 0.00501 109730 0.99757 0.99847 0.99847 6e-05 0.00038 0.998      0.999        0.998           1     0.998
##   Squirrel.glider Yellow-bellied.glider
## 1           1.000                 1.000
## 2           1.000                 1.000
## 3           0.999                 1.000
## 4           0.999                 0.999
## 5           0.998                 0.999
## 6           0.998                 0.999</code></pre>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># Note! Using curves() variant.caz will work as well</span>
<span class="no">feature.curves.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">variant.caz</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">feature.curves.caz</span>)</pre></body></html></div>
<pre><code>##   pr_lost   cost  min_pr  ave_pr    w_pr  ext1    ext2 Koala Masked.owl Powerful.owl Tiger.quoll Sooty.owl
## 1 0.00002 110280 1.00000 1.00000 1.00000 0e+00 0.00000 1.000      1.000        1.000           1     1.000
## 2 0.00102 110170 0.99959 0.99976 0.99976 3e-05 0.00006 1.000      1.000        1.000           1     1.000
## 3 0.00201 110060 0.99915 0.99949 0.99949 4e-05 0.00013 0.999      1.000        0.999           1     0.999
## 4 0.00301 109950 0.99866 0.99918 0.99918 5e-05 0.00021 0.999      1.000        0.999           1     0.999
## 5 0.00401 109840 0.99813 0.99883 0.99883 6e-05 0.00029 0.998      0.999        0.998           1     0.999
## 6 0.00501 109730 0.99757 0.99847 0.99847 6e-05 0.00038 0.998      0.999        0.998           1     0.998
##   Squirrel.glider Yellow-bellied.glider
## 1           1.000                 1.000
## 2           1.000                 1.000
## 3           0.999                 1.000
## 4           0.999                 0.999
## 5           0.998                 0.999
## 6           0.998                 0.999</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># Get just 2 species</span>
<span class="no">duo.curves.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">results.caz</span>, <span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Koala"</span>, <span class="st">"Tiger.quoll"</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">duo.curves.caz</span>)</pre></body></html></div>
<pre><code>##   pr_lost Koala Tiger.quoll
## 1 0.00002 1.000           1
## 2 0.00102 1.000           1
## 3 0.00201 0.999           1
## 4 0.00301 0.999           1
## 5 0.00401 0.998           1
## 6 0.00501 0.998           1</code></pre>
<p>Columns are exactly the same as in Zonation curves output file. Note also that the actual feature columns are named according to feature names in the <code>Zvariant</code> object these results were derived from. Thus whatever names you assigned to features prior to extracting the results will be also seen here.</p>
<p>Let’s see what the group curves data looks like as a whole or for individual groups:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># Get group-specific curves</span>
<span class="no">feature.grp.curves.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">results.caz</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">feature.grp.curves.caz</span>)</pre></body></html></div>
<pre><code>##   pr_lost   cost min.mammals mean.mammals max.mammals w.mean.mammals ext2.mammals min.owls mean.owls max.owls
## 1 0.00002 110280       1.000      1.00000           1        1.00000           NA    1.000 1.0000000    1.000
## 2 0.00102 110170       1.000      1.00000           1        1.00000           NA    1.000 1.0000000    1.000
## 3 0.00201 110060       0.999      0.99950           1        0.99950           NA    0.999 0.9993333    1.000
## 4 0.00301 109950       0.999      0.99925           1        0.99925           NA    0.999 0.9993333    1.000
## 5 0.00401 109840       0.998      0.99875           1        0.99875           NA    0.998 0.9986667    0.999
## 6 0.00501 109730       0.998      0.99875           1        0.99875           NA    0.998 0.9983333    0.999
##   w.mean.owls ext2.owls
## 1   1.0000000        NA
## 2   1.0000000        NA
## 3   0.9993333        NA
## 4   0.9993333        NA
## 5   0.9986667        NA
## 6   0.9983333        NA</code></pre>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># Get all the aggregate stats for owls</span>
<span class="no">owls.grp.curves.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">results.caz</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                              <span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"min.owls"</span>, <span class="st">"mean.owls"</span>, <span class="st">"max.owls"</span>,
                                     <span class="st">"w.mean.owls"</span>, <span class="st">"ext2.owls"</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">owls.grp.curves.caz</span>)</pre></body></html></div>
<pre><code>##   pr_lost min.owls mean.owls max.owls w.mean.owls ext2.owls
## 1 0.00002    1.000 1.0000000    1.000   1.0000000        NA
## 2 0.00102    1.000 1.0000000    1.000   1.0000000        NA
## 3 0.00201    0.999 0.9993333    1.000   0.9993333        NA
## 4 0.00301    0.999 0.9993333    1.000   0.9993333        NA
## 5 0.00401    0.998 0.9986667    0.999   0.9986667        NA
## 6 0.00501    0.998 0.9983333    0.999   0.9983333        NA</code></pre>
<p>Often a particular range of cell removal process is more interesting than the whole range. <code><a href="../reference/curves-methods.html">curves()</a></code> has arguments <code>lost.lower</code> and <code>lost.upper</code> to define a specific range:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="co"># Get performance values for 2 species for a range between 60% and 75% of </span>
<span class="co"># landscape lost </span>
<span class="no">duo.curves.caz.range</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">results.caz</span>, <span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Koala"</span>, <span class="st">"Tiger.quoll"</span>),
                               <span class="kw">lost.lower</span> <span class="kw">=</span> <span class="fl">0.6</span>, <span class="kw">lost.upper</span> <span class="kw">=</span> <span class="fl">0.75</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">duo.curves.caz.range</span>)</pre></body></html></div>
<pre><code>##   pr_lost Koala Tiger.quoll
## 1 0.60047 0.489       0.509
## 2 0.60147 0.488       0.508
## 3 0.60247 0.486       0.506
## 4 0.60347 0.485       0.505
## 5 0.60446 0.484       0.504
## 6 0.60546 0.483       0.503</code></pre>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">duo.curves.caz.range</span>)</pre></body></html></div>
<pre><code>##     pr_lost Koala Tiger.quoll
## 145 0.74410 0.326       0.338
## 146 0.74510 0.325       0.337
## 147 0.74610 0.324       0.335
## 148 0.74710 0.323       0.334
## 149 0.74809 0.322       0.333
## 150 0.74909 0.320       0.332</code></pre>
<p>Sometimes you might also be interested in performance values of features at specific levels of landscape protection. For example, how much of the original occurrence levels are remaining when 25%, 50%, and 75% of landscape is lost. Method <code><a href="../reference/performance-methods.html">performance()</a></code> can give you exactly this information.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co"># Define the levels of landscape lost</span>
<span class="no">lost.levels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>)
<span class="co"># Notice that performance operates with Zresults-object</span>
<span class="fu"><a href="../reference/performance-methods.html">performance</a></span>(<span class="no">results.caz</span>, <span class="no">lost.levels</span>)</pre></body></html></div>
<pre><code>##   pr_lost Koala Masked.owl Powerful.owl Tiger.quoll Sooty.owl Squirrel.glider Yellow-bellied.glider
## 1 0.25037 0.851      0.853        0.816       0.900     0.865           0.813                 0.811
## 2 0.50073 0.601      0.633        0.598       0.622     0.667           0.582                 0.575
## 3 0.75009 0.319      0.345        0.312       0.330     0.403           0.300                 0.299</code></pre>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># Same can be done for groups</span>
<span class="fu"><a href="../reference/performance-methods.html">performance</a></span>(<span class="no">results.caz</span>, <span class="no">lost.levels</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>##   pr_lost min.mammals mean.mammals max.mammals w.mean.mammals ext2.mammals min.owls mean.owls max.owls w.mean.owls
## 1 0.25037       0.811      0.84375       0.900        0.84375           NA    0.816 0.8446667    0.865   0.8446667
## 2 0.50073       0.575      0.59500       0.622        0.59500           NA    0.598 0.6326667    0.667   0.6326667
## 3 0.75009       0.299      0.31200       0.330        0.31200           NA    0.312 0.3533333    0.403   0.3533333
##   ext2.owls
## 1        NA
## 2        NA
## 3        NA</code></pre>
<p><strong>Pro tip!</strong> If you’re a heavy user of Hadley Wickham’s excellent <a href="https://ggplot2.tidyverse.org">ggplot2</a> package you might a lot of time <a href="http://www.statmethods.net/management/reshape.html">reshaping</a> your data. Method <code><a href="../reference/performance-methods.html">performance()</a></code> also has an optional argument <code>melted</code> which if set TRUE will make the method return performance data in a melted format and thus readily suitable for ggplot2-plotting (see below for a plotting example).</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co"># Define the levels of landscape lost</span>
<span class="no">lost.levels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>)
<span class="co"># Notice that performance operates with Zresults-object</span>
<span class="fu"><a href="../reference/performance-methods.html">performance</a></span>(<span class="no">results.caz</span>, <span class="no">lost.levels</span>, <span class="kw">melted</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>##                  feature pr.lost perf.levels
## 1                  Koala    0.25       0.851
## 2             Masked.owl    0.25       0.853
## 3           Powerful.owl    0.25       0.816
## 4            Tiger.quoll    0.25       0.900
## 5              Sooty.owl    0.25       0.865
## 6        Squirrel.glider    0.25       0.813
## 7  Yellow-bellied.glider    0.25       0.811
## 8                  Koala    0.50       0.601
## 9             Masked.owl    0.50       0.633
## 10          Powerful.owl    0.50       0.598
## 11           Tiger.quoll    0.50       0.622
## 12             Sooty.owl    0.50       0.667
## 13       Squirrel.glider    0.50       0.582
## 14 Yellow-bellied.glider    0.50       0.575
## 15                 Koala    0.75       0.319
## 16            Masked.owl    0.75       0.345
## 17          Powerful.owl    0.75       0.312
## 18           Tiger.quoll    0.75       0.330
## 19             Sooty.owl    0.75       0.403
## 20       Squirrel.glider    0.75       0.300
## 21 Yellow-bellied.glider    0.75       0.299</code></pre>
</div>
<div id="plotting-performance-curves" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-performance-curves" class="anchor"></a>2.2 Plotting performance curves</h3>
<p>To make plotting examples more interesting, let’s use also another variant that uses Zonation’s masking capability.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="co"># Variant: 05_hierarchical_removal_mask</span>
<span class="no">variant.mask</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_variant-methods.html">get_variant</a></span>(<span class="no">tutorial.project</span>, <span class="st">"05"</span>)

<span class="fu"><a href="../reference/featurenames-methods.html">featurenames</a></span>(<span class="no">variant.mask</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Koala"</span>, <span class="st">"Masked.owl"</span>, <span class="st">"Powerful.owl"</span>,
                             <span class="st">"Tiger.quoll"</span>, <span class="st">"Sooty.owl"</span>, <span class="st">"Squirrel.glider"</span>,
                             <span class="st">"Yellow-bellied.glider"</span>)
<span class="no">labels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mammals"</span>, <span class="st">"owls"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">labels</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>)
<span class="fu"><a href="../reference/groupnames-methods.html">groupnames</a></span>(<span class="no">variant.mask</span>) <span class="kw">&lt;-</span> <span class="no">labels</span>

<span class="no">results.mask</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/results-methods.html">results</a></span>(<span class="no">variant.mask</span>)
<span class="no">feature.curves.mask</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">results.mask</span>)
<span class="no">feature.grp.curves.mask</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/curves-methods.html">curves</a></span>(<span class="no">results.mask</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>Performance data (curves) can also be easily plotted, feature- or group-wise:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">feature.curves.caz</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/curves-plotting-1-1.png" width="672"></p>
<p>Plotting-methods for <code>ZCurvesDataFrame</code> and <code>ZGroupCurvesDataFrame</code> classes include a couple of convenience arguments as well. By default, the scale on x-axis ranges from 0 to 1 and has a label “Prop. of landscape lost”. The other way of presenting the x-axis is to have it range from 1 to 0 and label it “Proportion of landscape under conservation”. This behavior can be controlled by using the argument <code>invert.x</code> for <code>plot-method</code>. The title of the plot can be set using <code>main</code>-argument.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">feature.curves.caz</span>, <span class="kw">invert.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"All features"</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/curves-plotting-2-1.png" width="672"></p>
<p>Argument <code>subs</code> can have a character vector of feature names to be plotted, i.e. a subset of all features. Different overall statistics can also be plotted. Statistics supported are: <code>mean</code>, <code>min</code>, and <code>w.mean</code> for feature-specific curves. Each of these is a logical argument that can be set to <code>TRUE</code>/<code>FALSE</code>. They correspond to “Average proportion remaining over all features”, “Minimum proportion remaining over all features”, and “Weighted average proportion remaining over all features” respectively.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">feature.curves.caz</span>, <span class="kw">invert.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Just few features"</span>,
     <span class="kw">subs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Yellow-bellied.glider'</span>, <span class="st">'Sooty.owl'</span>), <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/curves-plotting-3-1.png" width="672"></p>
<p>Group-specific curves can be plotted in similar fashion. Note that plotting group curves also respect the group names you may have set.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">feature.grp.curves.caz</span>, <span class="kw">invert.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"All groups"</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/curves-plotting-4-1.png" width="672"></p>
<p>Subsetting works the same as with individual features.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">feature.grp.curves.caz</span>, <span class="kw">invert.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"All groups"</span>,
     <span class="kw">subs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'owls'</span>))</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/curves-plotting-5-1.png" width="672"></p>
<p>Both feature- and group-specific curve plotting methods also have an argument called <code>monochrome</code>. Setting this argument to <code>TRUE</code> will use only monochrome colours which may be useful e.g. for publication figures.</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">feature.grp.curves.caz</span>, <span class="kw">invert.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"All groups"</span>,
     <span class="kw">monochrome</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/curves-plotting-6-1.png" width="672"></p>
<p>Group plotting also has a set of statistics which can be plotted, but the behavior is slightly different to that of features. What is plotted by default are group-specific mean values. Other statistics are <code>min</code>, <code>max</code>, and <code>w.mean</code> which correspond to “Minimum proportion remaining for a feature within group”, “Maxmimum proportion remaining for a feature within group”, and “Weighted average proportion remaining for group”. Note that <code>mean</code> will always be <code>TRUE</code> unless it’s explicitly set to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">feature.grp.curves.mask</span>, <span class="kw">invert.x</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"All groups"</span>,
     <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">min</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">max</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/curves-plotting-7-1.png" width="672"></p>
</div>
<div id="plotting-performance-levels" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-performance-levels" class="anchor"></a>2.3 Plotting performance levels</h3>
<p>If you want to summarize how much each feature has retained it’s occurrence level in a given stage of the cell removal process, you can easily created bar plots out of selected performance levels. For example, if you’d like to know how much of the original occurrence level each of species in our tutorial data has left when 10% percent of the landscape is under conservation, you could do the following:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="co"># NOTE: we're using melted=TRUE here</span>
<span class="no">occr.remaining</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/performance-methods.html">performance</a></span>(<span class="no">results.caz</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.98</span>), <span class="kw">melted</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">occr.remaining</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">feature</span>), <span class="kw">y</span> <span class="kw">=</span> <span class="no">perf.levels</span>,
                           <span class="kw">fill</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">pr.lost</span>))) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="kw">position</span> <span class="kw">=</span> <span class="st">"dodge"</span>, <span class="kw">stat</span> <span class="kw">=</span> <span class="st">"identity"</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/perfomance-hist-1.png" width="672"></p>
<hr>
</div>
</div>
<div id="raster-results" class="section level2">
<h2 class="hasAnchor">
<a href="#raster-results" class="anchor"></a>3. Raster results</h2>
<div id="priority-rank-rasters" class="section level3">
<h3 class="hasAnchor">
<a href="#priority-rank-rasters" class="anchor"></a>3.1. Priority rank rasters</h3>
<p>One of the main outputs of a Zonation analysis is the priority rank rasters which gives each cell in the landscape a value [0, 1] indicating the final priority rank (0 = the lowest, 1 = the highest). Rank raster is part of <code>Zresults</code> object just as the performance curves above. Method <code><a href="../reference/rank_raster-methods.html">rank_raster()</a></code> can be used to get the rank raster object. The color scheme used is really up to the user, but having a consistent and expressive color scheme for all the results helps. <code>zlegends()</code> can be used for ready-to-go color schemes that can used when plotting the raster objects.</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">raster</span>)</pre></body></html></div>
<pre><code>## Loading required package: sp</code></pre>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="no">rank.caz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rank_raster-methods.html">rank_raster</a></span>(<span class="no">results.caz</span>)
<span class="co"># Let's use a spectral color scheme designed for Zonation rank maps</span>
<span class="no">leg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/zlegend.html">zlegend</a></span>(<span class="st">"spectral"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(<span class="no">rank.caz</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="no">leg</span>$<span class="no">values</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">leg</span>$<span class="no">colors</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/rank-raster-1-1.png" width="672"></p>
<p>You can of course get all rank rasters individually from your project’s variants, but an alternative approach is to call <code><a href="../reference/rank_rasters-methods.html">rank_rasters()</a></code> (note the plural in method name!) directly on your project object. This will result in a <code>RasterStack</code> object containing all the rank rasters as respective layers. If you want to plot all rank rasters in your project for comparison, you could do the following:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="co"># RasterStack is returned</span>
<span class="no">all.ranks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rank_rasters-methods.html">rank_rasters</a></span>(<span class="no">tutorial.project</span>)
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(<span class="no">all.ranks</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="no">leg</span>$<span class="no">values</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">leg</span>$<span class="no">colors</span>, <span class="kw">nc</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/rank-raster-2-1.png" width="672"></p>
<p>Naturally, all methods defined for a <code>RasterStack</code> object are available. For example, checking the distributions of individual stack layers (i.e. rank rasters) and the correlation between the values of layers can be done using <code><a href="https://rdrr.io/pkg/raster/man/pairs.html">pairs()</a></code>. Following example examines correlation between variants 1-3.</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/pairs.html">pairs</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html">stack</a></span>(<span class="no">all.ranks</span><span class="kw">[[</span><span class="fl">1</span>:<span class="fl">3</span>]]), <span class="kw">method</span> <span class="kw">=</span> <span class="st">"kendall"</span>)</pre></body></html></div>
<p><img src="zonator-results_files/figure-html/rank-raster-3-1.png" width="672"></p>
<p>Values are sampled from the whole distribution of values to increase execution speed. Note also that we are using <code>kendall</code> as method for correlation.</p>
<p>Masking is another useful analysis tool. In the following example we are using the mask file <code>mask_rs.tif</code> shipping with Zonation basic tutorial in order to inspect the distribution of priorities within a subset of the landscape (i.e. protected areas, PAs). In the following example, note that method <code><a href="../reference/rank_raster-methods.html">rank_raster()</a></code> has been implemented for class <code>Zvariant</code>. In other words, you can call it on both your variant or results object. <code><a href="../reference/plot_hist.html">plot_hist()</a></code> accepts two rasters as arguments: first is the rank raster and the second one is a mask raster. Histogram is then plotted based on the values of the rank raster within the mask raster.</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">pas.file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/data"</span>, <span class="st">"mask_rs.tif"</span>,
                        <span class="kw">package</span> <span class="kw">=</span> <span class="st">"zdat"</span>)
<span class="no">pas</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span>(<span class="no">pas.file</span>)
<span class="co"># Re-class zeros as NA</span>
<span class="no">pas</span>[<span class="no">pas</span> <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="co"># Plot the histogram of rank.caz within mask raster</span>
<span class="fu"><a href="../reference/plot_hist.html">plot_hist</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">rank.caz</span>, <span class="no">pas</span>, <span class="kw">add.median</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 349944 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="zonator-results_files/figure-html/rank-raster-4-1.png" width="672"></p>
<p><a href="http://oscarperpinan.github.io/rastervis/">rasterVis</a> is another useful package for plotting raster data. For example, <code><a href="https://rdrr.io/pkg/rasterVis/man/levelplot-methods.html">levelplot()</a></code> can be used to plot data and show a marginal plot of of a function across each coordinate (here using mean):</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rasterVis</span>)
<span class="co"># Note that breaks in the following are different from the previous maps</span>
<span class="fu"><a href="https://rdrr.io/pkg/rasterVis/man/levelplot-methods.html">levelplot</a></span>(<span class="no">rank.caz</span>, <span class="kw">FUN.margin</span> <span class="kw">=</span> <span class="no">mean</span>,
          <span class="kw">par.settings</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rasterVis/man/rasterTheme.html">rasterTheme</a></span>(<span class="kw">region</span> <span class="kw">=</span> <span class="no">leg</span>$<span class="no">colors</span>))</pre></body></html></div>
<pre><code>## Warning in .local(x, data = data, ...): FUN.margin is deprecated. Use margin as a list instead.</code></pre>
<p><img src="zonator-results_files/figure-html/rank-rasterVis-1-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joona Lehtomaki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
